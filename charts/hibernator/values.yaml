# Default values for Hibernator Operator

replicaCount: 2

image:
  controller:
    repository: ghcr.io/ardikabs/hibernator
    pullPolicy: IfNotPresent
    tag: "latest"

  runner:
    repository: ghcr.io/ardikabs/hibernator-runner
    pullPolicy: Always
    tag: "latest"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations:
    # IRSA annotations for AWS (uncomment and fill if using AWS)
    # eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT_ID:role/hibernator-controller
  name: ""

runnerServiceAccount:
  create: true
  annotations: {}
  name: "hibernator-runner"

rbac:
  create: true

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65532
  fsGroup: 65532

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true

resources:
  controller:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 256Mi

  runner:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 4
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Leader election configuration
leaderElection:
  enabled: true
  namespace: ""

# Webhook configuration
webhook:
  enabled: true
  port: 9443
  certManager:
    enabled: false
    issuer: selfsigned-issuer
  certs:
    # If certManager is disabled, provide custom certs or let auto-generation create them
    secretName: webhook-server-cert
    certDir: /tmp/k8s-webhook-server/serving-certs
    caBundle: ""  # Optional: Manually provided CA bundle (base64 encoded)
  certGen:
    duration: 87600  # Certificate duration in hours (10 years for Helm-generated certs)

    # Set useJob: true to use Job-based generation (doesn't work with helm template/Kustomize)
    useJob: true
    # Image used for automatic certificate generation via Job (when certManager.enabled=false, certGen.useJob=true)
    image:
      repository: registry.k8s.io/ingress-nginx/kube-webhook-certgen
      tag: v1.4.0
      pullPolicy: IfNotPresent
    resources:
      limits:
        cpu: 100m
        memory: 128Mi
      requests:
        cpu: 50m
        memory: 64Mi

# Control plane configuration
controlPlane:
  endpoint: "hibernator.hibernator-system.svc"

# Operator configuration
operator:
  # Number of concurrent reconciliations
  workers: 1

  # Sync period for reconciliation
  syncPeriod: 10h

# CRD configuration
crds:
  create: true
  upgrade: true

# Namespace where the operator is installed
namespace: hibernator-system

# Additional labels to apply to all resources
labels: {}

# Additional annotations to apply to all resources
annotations: {}

# Example AWS CloudProvider to create (optional)
# aws:
#   enabled: false
#   accountId: "123456789012"
#   region: "us-east-1"
#   role: "hibernator-controller"

# Example GCP CloudProvider to create (optional)
# gcp:
#   enabled: false
#   projectId: "my-project"
#   region: "us-central1"
